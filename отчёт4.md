## Лабораторная работа 4. BIOPYTHON. Вариант 4.
# Задание 1. Формирование исходного файла.
# ЦЕЛЬ: 
Сформировать единый файл в формате GenBank, содержащий кодирующие последовательности (CDS) двух биологических видов, для последующего анализа и обработки данных.
# ЗАДАЧИ: 
1. Выполнить поиск кодирующих последовательностей (complete cds) для двух заданных видов на сайте NCBI.
2. Выбрать по 5 записей для каждого вида и скачать их в формате GenBank.
3. Объединить полученные файлы средствами Biopython в один общий файл.
4. Проверить корректность объединения и убедиться, что файл содержит минимум 10 кодирующих областей (CDS).
5. Подготовить файл для дальнейшего анализа, визуализации или биоинформатических исследований.
# ХОД РАБОТЫ. 
Разберём мой код:
1. Импорт необходимых модулей:

Entrez (из Bio) — позволяет делать запросы к базе данных NCBI.

SeqIO (из Bio) — используется для обработки и сохранения последовательностей.

2. Определение списка видов:

species_names = ["Brassica oleracea", "Solanum lycopersicum"]: список из двух видов, для которых нужно загрузить данные.

3. Создание пустого списка records

records = []: в него будут добавляться загруженные последовательности.

4. Запрос к NCBI для каждого вида:

search_handle = Entrez.esearch(db="nucleotide", term=f"{species} complete cds", retmax=5)

search_results = Entrez.read(search_handle)

search_handle.close()

-esearch() выполняет поиск complete cds для указанного вида.

-retmax=5 ограничивает количество загружаемых записей до пяти.

-search_results["IdList"] возвращает список идентификаторов последовательностей.

5. Загрузка данных по найденным ID:

for seq_id in id_list:
    fetch_handle = Entrez.efetch(db="nucleotide", id=seq_id, rettype="gb", retmode="text")
    records.append(SeqIO.read(fetch_handle, "genbank"))
    fetch_handle.close()

-efetch() загружает каждую последовательность в формате GenBank.

-SeqIO.read(fetch_handle, "genbank") преобразует полученные данные в объект, который добавляется в records.

6. Сохранение объединённого файла:

with open(output_file, "w") as output_handle:
    SeqIO.write(records, output_handle, "genbank")
Записанные последовательности сохраняются в merged_sequences.gb.

7. Вывод результата:

print(f"Все записи успешно сохранены в {output_file}.")

После выполнения программа сообщает, что данные сохранены.
# ВЫВОД: 
В ходе задания был автоматически загружен набор кодирующих последовательностей (CDS) для двух биологических видов из базы данных NCBI, объединён в единый файл GenBank и сохранён. Итоговый файл содержит минимум 10 кодирующих областей,готовых для дальнейшего анализа в биоинформатических исследованиях.

Задание 2. GC-составы.
ЦЕЛЬ: Прочитать и обработать данные из объединённого файла GenBank, определив GC-состав (процентное содержание гуанина и цитозина) для каждой последовательности и вывести их в порядке возрастания GC-составов.
ЗАДАЧА:Входным файлом является файл GenBank, составленный в задании 1. Нужно прочитать все записи и вывести последовательности в порядке возрастания их GC-составов.
АЛГОРИТМ ДЕЙСТВИЙ: Этот код анализирует содержимое файла GenBank, извлекает последовательности, вычисляет их GC-состав (процент гуанина и цитозина) и сортирует их по возрастанию GC-составов.
Он обрабатывает возможные ошибки (например, отсутствующие данные или файлы) и выводит результаты с идентификатором записи и её описанием.
ВЫВОД: В ходе задания был успешно прочитан файл GenBank, обработаны все записи и вычислены их GC-составы. Записи были упорядочены по возрастанию GC-составов, 
что позволяет анализировать различия в составе генетических данных.

Задание 3. Трансляция.
ЦЕЛЬ: Прочитать файл GenBank, содержащий кодирующие последовательности (CDS), выполнить трансляцию ДНК в белковые последовательности и вывести полученные результаты.
Каждая белковая последовательность должна быть сопоставлена с исходной кодирующей областью и видом, которому она принадлежит.
ЗАДАЧА: Входным файлом является файл GenBank, составленный в задании 1. Нужно вывести все белковые последовательности, которые получаются в результате трансляции кодирующих областей 
в заданных последовательностях. При этом должно быть указано, какой участок какой из заданных последовательностей кодируется в полученную белковую последовательность. 
АЛГОРИТМ ДЕЙСТВИЙ: Этот код загружает файл GenBank, ищет кодирующие области (CDS), извлекает их ДНК-последовательности и выполняет трансляцию в белковые последовательности.
Он определяет расположение CDS, учитывает направление цепи (+ или -) и выводит полученный белок. Код также обрабатывает ошибки, если трансляция невозможна.
ВЫВОД: В ходе задания были успешно извлечены кодирующие области (CDS) из файла GenBank и выполнена их трансляция в белковые последовательности.
Каждая последовательность была сопоставлена с её расположением в исходной ДНК и направлением цепи. Этот анализ позволяет изучать аминокислотные составы генов, 
проводить сравнительные исследования белков и получать важные биоинформатические данные.

